<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mapa Interactivo</title>
</head>
<body>
    <h1>Ruta Logística</h1>
   
        <label for="destino">Introduce la ciudad de destino:</label>
        <input type="text" id="destino" name="destino" required>
        <button id="enviar" type="button">Generar Mapa</button>
   
    <p id="mensaje"></p>
    <iframe id="mapa" src="" width="100%" height="800px" style="border:1px solid #ccc;"></iframe>
    <script>
        // Escucha el evento de clic del botón "Generar Mapa"
        document.getElementById('enviar').addEventListener('click', async (e) => {
            e.preventDefault(); // Asegura que no se haga ninguna acción por defecto (si aplicara)
            
            // Obtener el valor del campo "destino"
            const destino = document.getElementById('destino').value;

            // Validar que el campo no esté vacío
            if (!destino) {
                document.getElementById('mensaje').innerText = 'Por favor, introduce un destino.';
                return;
            }

            // Hacer la solicitud al servidor
            try {
                const response = await fetch('http://localhost:5000', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ destino })
                });

                const data = await response.json();
                if (data.success) {
                    // Cambiar el src del iframe para mostrar el mapa generado
                    document.getElementById('mapa').src = "LogisticaPeninsula.html";
                    document.getElementById('mensaje').innerText = "Mapa generado correctamente.";
                } else {
                    document.getElementById('mensaje').innerText = `Error: ${data.error}`;
                }
            } catch (error) {
                document.getElementById('mensaje').innerText = 'Error al comunicar con el servidor.';
            }
        });
    </script>
</body>
</html>
